/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){"function"==typeof define&&define.amd?define(t):e.RSSApp=t()})(this,function(){function e(e){for(var t,i=document.getElementsByTagName("head")[0],n=i.childNodes[0],s=0,o=e.length;o>s;++s)t=document.createElement("link"),t.type="text/css",t.rel="stylesheet",t.href=e[s],i.insertBefore(t,n)}function t(){n(["meems","view/phone","viewmodel/phone"],function(t,i,n){var s=t.Utils,o=t.Scroll,r=t.Events,a="css/meems/",l=s.Dom.userAgent();e([a+l+"/ui.css",a+l+"/icons.css",a+l+"/effects.css"]);var u=new i;n.init(u),u.refresh(),r.Dom.on(window,"resize",s.Fn.throttle(o.updateAll,100)),document.body.appendChild(u.ui.el()),o.updateAll()})}var i,n,s;return function(e){function t(e,t){return y.call(e,t)}function o(e,t){var i,n,s,o,r,a,l,u,h,c,d=t&&t.split("/"),m=g.map,p=m&&m["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=d.concat(e.split("/")),u=0;e.length>u;u+=1)if(c=e[u],"."===c)e.splice(u,1),u-=1;else if(".."===c){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||p)&&m){for(i=e.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),d)for(h=d.length;h>0;h-=1)if(s=m[d.slice(0,h).join("/")],s&&(s=s[n])){o=s,r=u;break}if(o)break;!a&&p&&p[n]&&(a=p[n],l=u)}!o&&a&&(o=a,r=l),o&&(i.splice(0,r,o),e=i.join("/"))}return e}function r(t,i){return function(){return m.apply(e,w.call(arguments,0).concat([t,i]))}}function a(e){return function(t){return o(t,e)}}function l(e){return function(t){v[e]=t}}function u(i){if(t($,i)){var n=$[i];delete $[i],b[i]=!0,d.apply(e,n)}if(!t(v,i)&&!t(b,i))throw Error("No "+i);return v[i]}function h(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function c(e){return function(){return g&&g.config&&g.config[e]||{}}}var d,m,p,f,v={},$={},g={},b={},y=Object.prototype.hasOwnProperty,w=[].slice;p=function(e,t){var i,n=h(e),s=n[0];return e=n[1],s&&(s=o(s,t),i=u(s)),s?e=i&&i.normalize?i.normalize(e,a(t)):o(e,t):(e=o(e,t),n=h(e),s=n[0],e=n[1],s&&(i=u(s))),{f:s?s+"!"+e:e,n:e,pr:s,p:i}},f={require:function(e){return r(e)},exports:function(e){var t=v[e];return t!==void 0?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:c(e)}}},d=function(i,n,s,o){var a,h,c,d,m,g,y=[];if(o=o||i,"function"==typeof s){for(n=!n.length&&s.length?["require","exports","module"]:n,m=0;n.length>m;m+=1)if(d=p(n[m],o),h=d.f,"require"===h)y[m]=f.require(i);else if("exports"===h)y[m]=f.exports(i),g=!0;else if("module"===h)a=y[m]=f.module(i);else if(t(v,h)||t($,h)||t(b,h))y[m]=u(h);else{if(!d.p)throw Error(i+" missing "+h);d.p.load(d.n,r(o,!0),l(h),{}),y[m]=v[h]}c=s.apply(v[i],y),i&&(a&&a.exports!==e&&a.exports!==v[i]?v[i]=a.exports:c===e&&g||(v[i]=c))}else i&&(v[i]=s)},i=n=m=function(t,i,n,s,o){return"string"==typeof t?f[t]?f[t](i):u(p(t,i).f):(t.splice||(g=t,i.splice?(t=i,i=n,n=null):t=e),i=i||function(){},"function"==typeof n&&(n=s,s=o),s?d(e,t,i,n):setTimeout(function(){d(e,t,i,n)},4),m)},m.config=function(e){return g=e,g.deps&&m(g.deps,g.callback),m},s=function(e,i,n){i.splice||(n=i,i=[]),t(v,e)||t($,e)||($[e]=[e,i,n])},s.amd={jQuery:!0}}(),s("../tools/almond",function(){}),function(e,t){"function"==typeof s&&s.amd?s("meems",t):e.Meems=t()}(this,function(){var e,t,i;return function(n){function s(e,t){return y.call(e,t)}function o(e,t){var i,n,s,o,r,a,l,u,h,c,d=t&&t.split("/"),m=g.map,p=m&&m["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=d.concat(e.split("/")),u=0;e.length>u;u+=1)if(c=e[u],"."===c)e.splice(u,1),u-=1;else if(".."===c){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||p)&&m){for(i=e.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),d)for(h=d.length;h>0;h-=1)if(s=m[d.slice(0,h).join("/")],s&&(s=s[n])){o=s,r=u;break}if(o)break;!a&&p&&p[n]&&(a=p[n],l=u)}!o&&a&&(o=a,r=l),o&&(i.splice(0,r,o),e=i.join("/"))}return e}function r(e,t){return function(){return m.apply(n,w.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return o(t,e)}}function l(e){return function(t){v[e]=t}}function u(e){if(s($,e)){var t=$[e];delete $[e],b[e]=!0,d.apply(n,t)}if(!s(v,e)&&!s(b,e))throw Error("No "+e);return v[e]}function h(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function c(e){return function(){return g&&g.config&&g.config[e]||{}}}var d,m,p,f,v={},$={},g={},b={},y=Object.prototype.hasOwnProperty,w=[].slice;p=function(e,t){var i,n=h(e),s=n[0];return e=n[1],s&&(s=o(s,t),i=u(s)),s?e=i&&i.normalize?i.normalize(e,a(t)):o(e,t):(e=o(e,t),n=h(e),s=n[0],e=n[1],s&&(i=u(s))),{f:s?s+"!"+e:e,n:e,pr:s,p:i}},f={require:function(e){return r(e)},exports:function(e){var t=v[e];return void 0!==t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:c(e)}}},d=function(e,t,i,o){var a,h,c,d,m,g,y=[];if(o=o||e,"function"==typeof i){for(t=!t.length&&i.length?["require","exports","module"]:t,m=0;t.length>m;m+=1)if(d=p(t[m],o),h=d.f,"require"===h)y[m]=f.require(e);else if("exports"===h)y[m]=f.exports(e),g=!0;else if("module"===h)a=y[m]=f.module(e);else if(s(v,h)||s($,h)||s(b,h))y[m]=u(h);else{if(!d.p)throw Error(e+" missing "+h);d.p.load(d.n,r(o,!0),l(h),{}),y[m]=v[h]}c=i.apply(v[e],y),e&&(a&&a.exports!==n&&a.exports!==v[e]?v[e]=a.exports:c===n&&g||(v[e]=c))}else e&&(v[e]=i)},e=t=m=function(e,t,i,s,o){return"string"==typeof e?f[e]?f[e](t):u(p(e,t).f):(e.splice||(g=e,t.splice?(e=t,t=i,i=null):e=n),t=t||function(){},"function"==typeof i&&(i=s,s=o),s?d(n,e,t,i):setTimeout(function(){d(n,e,t,i)},4),m)},m.config=function(e){return g=e,g.deps&&m(g.deps,g.callback),m},i=function(e,t,i){t.splice||(i=t,t=[]),s(v,e)||s($,e)||($[e]=[e,t,i])},i.amd={jQuery:!0}}(),i("../tools/almond",function(){}),i("observable",[],function(){function e(t){var i=function(e){var t=arguments.callee;if(void 0===e)return t.$currentVal;var i=t.$currentVal;return t.$currentVal=e,t.notify(i,e),this};return i.$currentVal=t,i.$observers=[],i.subscribe=e.prototype.subscribe,i.unsubscribe=e.prototype.unsubscribe,i.notify=e.prototype.notify,i}e.prototype.subscribe=function(e){return this.$observers.push(e),this},e.prototype.unsubscribe=function(e){return this.$observers.remove(e),this},e.prototype.notify=function(e,t){for(var i=0,n=this.$observers.length;n>i;++i)this.$observers[i].call(this,e,t);return this};var t=function(e){return function(){var t=this.$currentVal;e.apply(this.$currentVal,arguments),this.notify(t,this.$currentVal)}},i={indexOf:t(Array.prototype.indexOf),push:t(Array.prototype.push),pop:t(Array.prototype.pop),slice:t(Array.prototype.slice),splice:t(Array.prototype.splice),shift:t(Array.prototype.shift),unshift:t(Array.prototype.unshift),reverse:t(Array.prototype.reverse),sort:t(Array.prototype.sort),remove:function(e){var t=this.$currentVal.indexOf(e);t>-1&&this.$currentVal.splice(t,1)},removeAll:function(e){var t,i,n,s,o;for(t=0,i=e.length;i>t;++t)for(o=e[t],n=0,s=this.$currentVal.length;s>n;++n)this.$currentVal[n]===o&&(this.$currentVal.splice(n,1),--n,--s)}},n={observable:function(t){return new e(t)},observableArray:function(e){var t=n.observable(e||[]);for(var s in i)t[s]=i[s];return t}};return n}),i("meems-utils",[],function(){function e(e,t){return"json"===e?JSON.stringify(t):"url"===e?h(t):void 0}function t(e,t){if("text"===e)return t;if("json"===e)return JSON.parse(t);if("xml"===e){var i=new DOMParser;return i.parseFromString(t,"application/xml")}}var i=document.head||document.getElementsByTagName("head")[0],n="ontouchstart"in window,s={},o={},r=0,a={},l=function(){var e;return(e=/theme=(\w+)/.exec(window.location.search))?e[1]:null!=navigator.userAgent.match(/iPad|iPhone|Safari/i)?"ios":null!=navigator.userAgent.match(/Android/i)?"android":void 0}(),u=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],i=0,n=t.length;n>i;++i)try{return e=new ActiveXObject(t[i])}catch(s){}},h=function(e,t){var i=[];for(var n in e){var s=t?t+"["+n+"]":n,o=e[n];i.push("object"==typeof o?h(o,s):encodeURIComponent(s)+"="+encodeURIComponent(o))}return i.join("&")},c={Ajax:{request:function(i){var n=u();n.onreadystatechange=function(){if(!(4>n.readyState)){if(200!==n.status)return i.done({statusCode:n.status}),void 0;if(4===n.readyState){var e=i.decoding||"text";i.done({statusCode:n.status,response:t(e,n.responseText)})}}};var s=i.url,o=i.headers||{},r=i.method||"GET",a=i.format||"url";"GET"===r?n.open(r,s+"?"+e("url",i.params),!0):n.open(r,s,!0),"withCredentials"in n&&(n.withCredentials=!0),"url"===a?n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"json"===a?n.setRequestHeader("Content-Type","application/json"):"xml"===a&&n.setRequestHeader("Content-Type","application/xml");for(var l in o)o.hasOwnProperty(l)&&n.setRequestHeader(l,o[l]);"GET"===r?n.send():n.send(e(a,i.params))}},Fn:{extend:function(e,t,i){"function"==typeof e&&(e.prototype=new t,e.constructor=e,e=e.prototype);for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},postPone:function(e){setTimeout(e,10)},bind:function(e,t){return function(){e.apply(t,arguments)}},throttle:function(e,t){var i,n;return function(){if(n=(new Date).getTime(),!i||n-i>t){var s=e.apply(this,arguments);return i=n,s}}}},Array:{indexOfByProp:function(e,t,i){for(var n=0;e.length>n;++n)if(e[n][t]===i)return n;return-1},remove:function(e,t){for(var i=0,n=e.length;n>i;++i)if(e[i]===t)return e.splice(i,0),void 0},moveElement:function(e,t,i){var n,s;if(t=parseInt(t,10),i=parseInt(i,10),t!==i&&t>=0&&e.length>=t&&i>=0&&e.length>=i){if(s=e[t],i>t)for(n=t;i>n;n++)e[n]=e[n+1];else for(n=t;n>i;n--)e[n]=e[n-1];e[i]=s}}},Map:{getKeys:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t}},Dom:{getClass:function(e){return e.$meems_uid?e.$meems_uid in s&&s[e.$meems_uid]||(s[e.$meems_uid]=e.className):(e.$meems_uid=++r,a[e.$meems_uid]=e,s[e.$meems_uid]=e.className),s[e.$meems_uid]},addClass:function(e,t){var i=this.getClass(e);s[e.$meems_uid]=i.replace(RegExp("\\b"+t+"\\b"),"")+" "+t},removeClass:function(e,t){var i=this.getClass(e);s[e.$meems_uid]=i.replace(RegExp("\\b"+t+"\\b"),"")},setClass:function(e,t){e.$meems_uid||(e.$meems_uid=++r,a[e.$meems_uid]=e),s[e.$meems_uid]=t},setHtml:function(e,t){e.$meems_uid||(e.$meems_uid=++r,a[e.$meems_uid]=e),o[e.$meems_uid]=t},applyChanges:function(){var e,t,i;for(i in s)s.hasOwnProperty(i)&&(e=s[i],e&&(a[i].className=e));for(i in o)o.hasOwnProperty(i)&&(t=o[i],t&&(a[i].innerHTML=t));s={},o={}},fixedViewport:function(){var e=document.createElement("meta");e.setAttribute("name","viewport"),e.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1"),i.appendChild(e)},supportsTouch:function(){return n},getPosition:function(e){var t=e,i={x:0,y:0};do i.x+=t.offsetLeft,i.y+=t.offsetTop;while(t=t.offsetParent);return i},getRect:function(e){var t=c.Dom.getPosition(e);return t.width=e.offsetWidth,t.height=e.offsetHeight,t},getAbsolutePosition:function(e){for(var t=e,i={x:0,y:0};t&&"absolute"!==t.style.position;){i.x+=t.offsetLeft,i.y+=t.offsetTop,t=t.offsetParent;break}return i},getDimensions:function(e){var t=window.getComputedStyle(e,null);return{width:parseFloat(t.getPropertyValue("width")),height:parseFloat(t.getPropertyValue("height"))}},userAgent:function(){return l}}};return void 0===Function.prototype.extend&&(Function.prototype.extend=function(e,t){c.Fn.extend(this,e,t)}),c}),i("meems-events",[],function(){function e(){return this.$handlers={},this}var t,i,n,s;"ontouchstart"in window?(t="touchstart",n="touchmove",i="touchend",s=function(e){return{x:e.touches[0].pageX,y:e.touches[0].pageY}}):(t="mousedown",n="mousemove",i="mouseup",s=function(e){return{x:e.pageX,y:e.pageY}});var o=function(){function e(e,t,i){e.addEventListener(t,i,!0)}function t(e,t,i){e.attachEvent("on"+t,i)}function i(e,t,i){e["on"+t]=i}function n(e,t,i){e.removeEventListener(t,i,!0)}function s(e,t,i){e.detachEvent("on"+t,i)}function o(e,t){e["on"+t]=null}var r="addEventListener"in window,a="attachEvent"in window;return{on:r?e:a?t:i,off:r?n:a?s:o,cancelEvent:function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1}}}();e.prototype={on:function(e,t){return this.$handlers[e]=this.$handlers[e]||[],this.$handlers[e].push(t),this},off:function(e,t){return void 0!==this.$handlers[e]&&(this.$handlers[e]=this.$handlers[e].filter(function(e){return e!==t})),this},fire:function(e){for(var t=this.$handlers[e]||[],i=0;t.length>i;++i)t[i].apply(this,arguments);return this}};var r={Dom:o,Handler:e,Touch:{touchStartEventName:t,touchEndEventName:i,touchMoveEventName:n,getCursorPosition:s}};return r}),i("ui/widget",["meems-utils","meems-events"],function(e,t){function i(){return this.$el=null,this.$parent=null,this.$facets={},this.$attributes={},this.$eventHandlers=null,t.Handler.apply(this,arguments),this}return i.extend(t.Handler,{on:function(e,i){return 0===e.indexOf("dom:")?this.$el?t.Dom.on(this.el(),e.substr(4),function(){Array.prototype.unshift.call(arguments,e),i.apply(this,arguments)}):(this.$eventHandlers=this.$eventHandlers||[],this.$eventHandlers.push([e,i])):t.Handler.prototype.on.apply(this,arguments),this},off:function(e,i){return 0===e.indexOf("dom:")?t.Dom.off(this.el(),e.substr(4),i):t.Handler.prototype.off.apply(this,arguments),this},fire:function(){for(var e=this;e;)t.Handler.prototype.fire.apply(e,arguments),e=e.parent();return this},el:function(e){if(void 0===e)return this.$el;if(this.$el=e,this.$el&&this.$eventHandlers){for(var t,i=0,n=this.$eventHandlers.length;n>i;++i)t=this.$eventHandlers[i],this.on(t[0],t[1]);this.$eventHandlers=null}return this},facets:function(){return e.Map.getKeys(this.$facets)},parent:function(e){return void 0===e?this.$parent:(this.$parent=e,this)},facet:function(e,t){return void 0===t?this.$facets[e]:(this.$el&&this.$facets[e]&&this.$facets[e].el()&&this.$facets[e].el().parentNode===this.$el&&this.$el.removeChild(this.$facets[e].el()),this.$facets[e]=t,this)},attr:function(t,i){if(void 0===i){var n=this.$attributes[t];return"function"==typeof n?n():n}return this.$attributes[t]=i,i&&void 0!==i.subscribe&&"function"==typeof i.subscribe&&i.subscribe(function(t,i){return e.Fn.bind(function(e,i){this.partialUpdate(t,e,i)},i)}(t,this)),this},partialUpdate:function(){this.update()},update:function(){this.el()&&this.$attributes.customClass&&(e.Dom.addClass(this.el(),this.$attributes.customClass),this.$attributes.customClass=null)}}),i}),i("ui/header",["meems-utils","./widget"],function(e,t){function i(){return t.apply(this,arguments),this.facet("buttonsleft",null),this.facet("buttonsright",null),this.$titleEl=null,this}var n=999,s=e.Dom.userAgent();return console.log(s),n="ios"===s?1:2,i.extend(t,{partialUpdate:function(t,i,n){"title"===t&&this.$titleEl&&e.Dom.setHtml(this.$titleEl,"<h1>"+(n||"")+"</h1>")},update:function(i){this.el()||(this.el(document.createElement("div")),this.el().className="ui-header",this.$titleEl=document.createElement("div"),this.$titleEl.className="ui-title",this.el().appendChild(this.$titleEl)),e.Dom.setHtml(this.$titleEl,"<h1>"+(this.attr("title")||"")+"</h1>"),this.facet("buttonsleft")&&(this.facet("buttonsleft").attr("maxButtons",1),this.facet("buttonsleft").update(i),this.facet("buttonsleft").el().parentNode!==this.el()&&(e.Dom.addClass(this.facet("buttonsleft").el(),"ui-buttons-left"),this.el().insertBefore(this.facet("buttonsleft").el(),this.$titleEl))),this.facet("buttonsright")&&(this.facet("buttonsright").attr("maxButtons",n),this.facet("buttonsright").update(i),this.facet("buttonsright").el().parentNode!==this.el()&&(e.Dom.addClass(this.facet("buttonsright").el(),"ui-buttons-right"),this.el().appendChild(this.facet("buttonsright").el()))),t.prototype.update.apply(this,arguments)}}),i}),i("ui/footer",["meems-utils","./widget"],function(e,t){function i(){return t.apply(this,arguments),this.facet("buttons",null),this}return i.extend(t,{update:function(i){this.el()||(this.el(document.createElement("div")),e.Dom.addClass(this.el(),"ui-footer")),this.facet("buttons")&&(this.facet("buttons").update(i),this.facet("buttons").el().parentNode!==this.el()&&(e.Dom.addClass(this.facet("buttons").el(),"ui-buttons"),this.el().appendChild(this.facet("buttons").el()))),t.prototype.update.apply(this,arguments)}}),i}),i("meems-scroll",["meems-utils","meems-events"],function(e,t){function i(e,i){i.disableTouchEvents||(t.Dom.on(e,t.Touch.touchStartEventName,l),t.Dom.on(e,t.Touch.touchMoveEventName,h),t.Dom.on(e,t.Touch.touchEndEventName,c)),e.$meems_scroll=!0,e.$meems_config=i,e.style.overflow="hidden",e.$meems_content.style.position="absolute"}function n(e,i){delete e.$meems_scroll,delete e.$meems_config,i.disableTouchEvents||(t.Dom.off(e,t.Touch.touchStartEventName,l),t.Dom.off(e,t.Touch.touchMoveEventName,h),t.Dom.off(e,t.Touch.touchEndEventName,c))}function s(e){var t=e.target;if(t.className.indexOf("meems-scroll-skip")>-1)return null;for(;void 0===t.$meems_scroll&&t.parentNode;)t=t.parentNode;return t}function o(e,t,i,n,s,o,r){var a=t-i,l=a/s,u=Math.abs(l/e.friction),h=n-l*u;e.paging?(h>n+o?h=n+o:n-o>h&&(h=n-o),h=Math.round(h/o)*o):e.snap&&e.snap>0&&(h=Math.round(h/e.snap)*e.snap);var c=h;return o>r?0>c&&(c=0):-r+o>c&&(c=-r+o),c>0&&(c=0),h!==c&&(u*=Math.abs((t-c)/(t-h)),h=c),u>e.totalMaxTime&&(u=e.totalMaxTime),[h,u]}function r(){E=!0}function a(){E=!1}function l(e){var i=s(e);if(!i)return!0;var n=i.$meems_content,o=i.$meems_content_size?i.$meems_content_size.left||0:0,r=i.$meems_content_size?i.$meems_content_size.top||0:0;return i.$meems_content_size=F(n),i.$meems_content_size.left=o,i.$meems_content_size.top=r,i.$meems_old_pos={x:i.$meems_content_size.left,y:i.$meems_content_size.top},n.style[w]="",i.$meems_dragging=!0,i.$meems_dragging_start=(new Date).getTime(),i.$meems_cursor_pos=t.Touch.getCursorPosition(e),i.$meems_cursor_last_pos=i.$meems_cursor_pos,i.$meems_scrolling_running_animation=!1,i.$meems_drag_distance=0,i.$meems_effective_drag_distance=0,i.$meems_locked_axis=void 0,++D,$(i),!0}function u(i){if(E){var n=s(i);if(n){var r=n.$meems_content,a=n.$meems_content_size?n.$meems_content_size.left||0:0,l=n.$meems_content_size?n.$meems_content_size.top||0:0;n.$meems_content_size=F(r),n.$meems_content_size.left=a,n.$meems_content_size.top=l;var u=t.Touch.getCursorPosition(i),h=n.$meems_config,c=e.Dom.getPosition(n),m=n.$meems$elm_size.height,p=n.$meems_content_size.height;if(h.scrollY){var f=0;if(100>=u.y-c.y?f=50:100>=c.y+m-u.y&&(f=-50),0!==f){var v=o({paging:!1,snap:!1,totalMaxTime:.5,friction:h.friction},0,f,n.$meems_content_size.top,.5,m,p),$=v[0],g=v[1];d(n,null,null,$,g)}}}}}function h(e){if(!E||0>=D)return u(e),!0;var i=s(e);if(!i||!i.$meems_dragging)return u(e),!0;var n=i.$meems_config,o=t.Touch.getCursorPosition(e),r=i.$meems_cursor_pos.x-o.x,a=i.$meems_cursor_pos.y-o.y;if(n.minDistanceOfDrag>i.$meems_drag_distance)return i.$meems_drag_distance+=r*r+a*a,e.preventDefault&&e.preventDefault(),!0;n.axisLock&&void 0===i.$meems_locked_axis&&(i.$meems_locked_axis=r*r>a*a?"x":"y");var l,h;return!n.scrollX||"x"!==i.$meems_locked_axis&&void 0!==i.$meems_locked_axis||(l=i.$meems_old_pos.x-r,n.bouncing||(l>0?l=0:-i.$meems_content_size.width+i.$meems$elm_size.width>l&&(l=-i.$meems_content_size.width+i.$meems$elm_size.width)),i.$meems_effective_drag_distance+=r*r,n.hideScroller||(i.$meems_scrollbar_x.style.display="block")),!n.scrollY||"y"!==i.$meems_locked_axis&&void 0!==i.$meems_locked_axis||(h=i.$meems_old_pos.y-a,n.bouncing||(h>0?h=0:-i.$meems_content_size.height+i.$meems$elm_size.height>h&&(h=-i.$meems_content_size.height+i.$meems$elm_size.height)),i.$meems_effective_drag_distance+=a*a,n.hideScroller||(i.$meems_scrollbar_y.style.display="block")),T(i,l,h),i.$meems_cursor_last_pos=o,g(i,l,h),e.preventDefault&&e.preventDefault(),!0}function c(e){E=!1;var t=s(e);if(!t||!t.$meems_dragging)return!0;--D,t.$meems_dragging=!1;var i=t.$meems_config;if(i.minDistanceOfDrag>t.$meems_effective_drag_distance)return!0;var n,r,a,l,u,h,c=t.$meems_cursor_last_pos,m=((new Date).getTime()-t.$meems_dragging_start)/1e3;if(i.scrollY){var p=t.$meems$elm_size.height,f=t.$meems_content_size.height;n=o(i,t.$meems_cursor_pos.y,c.y,t.$meems_old_pos.y,m,p,f),r=n[0],a=n[1],n=null}if(i.scrollX){var v=t.$meems$elm_size.width,$=t.$meems_content_size.width;l=o(i,t.$meems_cursor_pos.x,c.x,t.$meems_old_pos.x,m,v,$),u=l[0],h=l[1],l=null}return d(t,u,h,r,a),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),void 0!==e.cancelBubble&&(e.cancelBubble=!0),!1}function d(t,i,n,s,o){var r=t.$meems_config,a=t.$meems_content,l=Math.max(n||0,o||0),u="all "+l+"s "+r.timingFunction;l>0&&(a.style[w]=u,window.requestAnimationFrame(function(){T(t,i,s),f(t,l),e.Fn.postPone(function(){t.$meems_handler.fire("scroll:end",-(i||0),-(s||0))})}))}function m(e,t){t.hideScroller||(e.$meems_scrollbar_y=document.createElement("div"),e.$meems_scrollbar_y.className="ui-scroll-bar-y",e.$meems_scrollbar_y.style.position="absolute",e.$meems_scrollbar_y.style.display="none",e.appendChild(e.$meems_scrollbar_y))}function p(e,t){t.hideScroller||(e.$meems_scrollbar_x=document.createElement("div"),e.$meems_scrollbar_x.className="ui-scroll-bar-x",e.$meems_scrollbar_x.style.position="absolute",e.$meems_scrollbar_x.style.display="none",e.appendChild(e.$meems_scrollbar_x))}function f(e,t){function i(){var t=(new Date).getTime();r-=a*(t-s),u&&(u.style.opacity=r),h&&(h.style.opacity=r),e.$meems_scrolling_running_animation&&m>t-d?(s=t,window.requestAnimationFrame(i)):(u&&(u.style.display="none",u.style.opacity=o),h&&(h.style.display="none",h.style.opacity=o),e.$meems_scrolling_running_animation=!1)}function n(){var t=(new Date).getTime();v(e,l),e.$meems_scrolling_running_animation&&c>t-d?window.requestAnimationFrame(n):(o=u&&document.defaultView.getComputedStyle(u,null).opacity||h&&document.defaultView.getComputedStyle(h,null).opacity||1,r=o,a=o/m,s=d=(new Date).getTime(),window.requestAnimationFrame(i))}var s,o,r,a,l=e.$meems_content,u=e.$meems_scrollbar_x,h=e.$meems_scrollbar_y,c=1e3*t,d=(new Date).getTime(),m=1e3*e.$meems_config.fadeOutDuration;e.$meems_scrolling_running_animation=!0,window.requestAnimationFrame(n)}function v(e,t){var i=e.$meems_config;if(!i.hideScroller){var n=function(){var i,n=document.defaultView.getComputedStyle(t,null);return null!==(i=n[x].match(N))?{left:parseFloat(i[1]),top:parseFloat(i[2])}:{left:e.$meems_content_size.left,top:e.$meems_content_size.top}}();if(i.scrollY){var s=e.$meems_scrollbar_y,o=e.$meems$elm_size.height,r=e.$meems_content_size.height,a=-n.top/r*o;s.style.top=a+"px"}if(i.scrollX){var l=e.$meems_scrollbar_x,u=e.$meems$elm_size.width,h=e.$meems_content_size.width,c=-n.left/h*u;l.style.left=c+"px"}}}function $(e){var t=e.$meems_config;if(!t.hideScroller){if(t.scrollY){var i=e.$meems$elm_size.height,n=e.$meems_content_size.height,s=Math.min(i,n)/n*i;e.$meems_scrollbar_y.style.height=s+"px"}if(t.scrollX){var o=e.$meems_scrollbar_x,r=e.$meems$elm_size.width,a=e.$meems_content_size.width,l=Math.min(r,a)/a*r;o.style.width=l+"px"}}}function g(e,t,i){var n=e.$meems_config;if(!n.hideScroller){if(n.scrollY){var s=e.$meems_scrollbar_y,o=e.$meems$elm_size.height,r=e.$meems_content_size.height,a=-i/r*o;s.style.top=a+"px"}if(n.scrollX){var l=e.$meems_scrollbar_x,u=e.$meems$elm_size.width,h=e.$meems_content_size.width,c=-t/h*u;l.style.left=c+"px"}}}function b(e,n){return t.Handler.apply(this,arguments),n=n||{},n.friction=n.friction||100,n.totalMaxTime=n.totalMaxTime||1,n.paging=n.paging===!0,n.snap=n.snap||0,n.scrollY=n.scrollY!==!1,n.scrollX=n.scrollX===!0,n.timingFunction=n.timingFunction||"ease-out",n.fadeOutDuration=n.fadeOutDuration||1,n.bouncing=n.bouncing!==!1,n.minDistanceOfDrag=n.minDistanceOfDrag||10,n.axisLock=n.axisLock!==!1,n.disableTouchEvents=n.disableTouchEvents===!0,n.hideScroller=n.hideScroller===!0,e.$meems_content=e.children[0],i(e,n),n.scrollY&&m(e,n),n.scrollX&&p(e,n),this.$elm=e,this.$elm.$meems_handler=this,this.$elm.$meems$elm_size=F(this.$elm),this.$elm.$meems_content_size=F(this.$elm.$meems_content),y.push(this),this}var y=[],w=function(){for(var e=document.body||document.documentElement,t=["transition","MozTransition","WebkitTransition","OTransition","MsTransition"],i=0;t.length>i;++i)if(t[i]in e.style)return t[i];return"transition"}(),_=function(){for(var e=document.body||document.documentElement,t=["transform","MozTransform","WebkitTransform"],i={cssName:"transition",jsName:"transition"},n=0;t.length>n;++n)if(t[n]in e.style){i.cssName=t[n],i.jsName=i.cssName.substring(0,1).toLowerCase()+i.cssName.substring(1);break}return i}(),C=_.cssName,x=_.jsName;_=null,function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;t.length>i&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),s=window.setTimeout(function(){t(i+n)},n);return e=i+n,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var D=0,E=!1,N=/[\-\d\.]+, [\-\d\.]+, [\-\d\.]+, [\-\d\.]+, ([\-\d\.]+), ([\-\d\.]+)/,T=function(e,t,i){var n=void 0===t?e.$meems_content_size.left||0:t||0,s=void 0===i?e.$meems_content_size.top||0:i||0;e.$meems_content.style[C]="translate3d("+n+"px,"+s+"px, 0)",e.$meems_content_size.left=n,e.$meems_content_size.top=s},F=function(e){return{left:e.offsetLeft,top:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}};return b.updateAll=function(){for(var e,t=0,i=y.length;i>t;++t)e=y[t],e.update()},b.extend(t.Handler,{update:function(){this.$elm.$meems$elm_size=F(this.$elm),this.$elm.$meems_content_size=F(this.$elm.$meems_content),v(this.$elm,this.$elm.$meems_content)},destroy:function(){y.splice(y.indexOf(this),0),n(this.$elm,this.$meems_config)},scrollTo:function(e,t,i){i=i||.25,this.$elm.$meems_config.hideScroller||(this.$elm.$meems_config.scrollY&&(this.$elm.$meems_scrollbar_y.style.display="block"),this.$elm.$meems_config.scrollX&&(this.$elm.$meems_scrollbar_x.style.display="block")),d(this.$elm,-e,i,-t,i)}}),t.Dom.on(document,t.Touch.touchStartEventName,r),t.Dom.on(document,t.Touch.touchEndEventName,a),b}),i("ui/page",["meems-utils","meems-scroll","./widget"],function(e,t,i){function n(){return i.apply(this,arguments),this.facet("header",null),this.facet("content",null),this.facet("footer",null),this.attr("enableScroll",!1),this.$contentWrapper=null,this.$scroller=null,this}return n.extend(i,{scroller:function(){return this.$scroller},update:function(n){this.el()||(this.el(document.createElement("div")),this.el().className="ui-page"),this.facet("header")&&(this.facet("header").update(n),this.facet("header").el().parentNode!==this.el()&&this.el().appendChild(this.facet("header").el())),this.facet("content")&&(this.facet("content").update(n),this.facet("content").el().parentNode&&this.facet("content").el().parentNode===this.$contentWrapper||(this.$contentWrapper=document.createElement("div"),this.$contentWrapper.className="ui-content",this.$contentWrapper.appendChild(this.facet("content").el()),this.el().appendChild(this.$contentWrapper))),this.facet("footer")&&(this.facet("footer").update(n),this.facet("footer").el().parentNode!==this.el()&&this.el().appendChild(this.facet("footer").el())),this.facet("content")&&(this.facet("header")?e.Dom.removeClass(this.$contentWrapper,"ui-header-off"):e.Dom.addClass(this.$contentWrapper,"ui-header-off"),this.facet("footer")?e.Dom.removeClass(this.$contentWrapper,"ui-footer-off"):e.Dom.addClass(this.$contentWrapper,"ui-footer-off")),this.attr("enableScroll")!==!0||this.$scroller||(this.$scroller=new t(this.$contentWrapper,{scrollX:!1,scrollY:!0,disableTouchEvents:!1,hideScroller:!1,friction:1e3})),i.prototype.update.apply(this,arguments)}}),n}),function(e,t){"object"==typeof exports&&exports?module.exports=t:"function"==typeof i&&i.amd?i("mustache",t):e.Mustache=t}(this,function(){function e(e,t){return RegExp.prototype.test.call(e,t)}function t(t){return!e(p,t)}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function n(e){return(e+"").replace(/[&<>"'\/]/g,function(e){return b[e]})}function s(e){this.string=e,this.tail=e,this.pos=0}function o(e,t){this.view=e,this.parent=t,this.clearCache()}function r(){this.clearCache()}function a(e){function t(e,t,n){if(!i[e]){var s=a(t);i[e]=function(e,t){return s(e,t,n)}}return i[e]}var i={};return function(i,n,s){for(var o,r,a="",l=0,u=e.length;u>l;++l)switch(o=e[l],o[0]){case"#":r=s.slice(o[3],o[5]),a+=i._section(o[1],n,r,t(l,o[4],s));break;case"^":a+=i._inverted(o[1],n,t(l,o[4],s));break;case">":a+=i._partial(o[1],n);break;case"&":a+=i._name(o[1],n);break;case"name":a+=i._escaped(o[1],n);break;case"text":a+=o[1]}return a}}function l(e){for(var t,i=[],n=i,s=[],o=0,r=e.length;r>o;++o)switch(t=e[o],t[0]){case"#":case"^":s.push(t),n.push(t),n=t[4]=[];break;case"/":var a=s.pop();a[5]=t[2],n=s.length>0?s[s.length-1][4]:i;break;default:n.push(t)}return i}function u(e){for(var t,i,n=[],s=0,o=e.length;o>s;++s)t=e[s],"text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(i=t,n.push(t));return n}function h(e){return[RegExp(i(e[0])+"\\s*"),RegExp("\\s*"+i(e[1]))]}var c={};c.name="mustache.js",c.version="0.7.2",c.tags=["{{","}}"],c.Scanner=s,c.Context=o,c.Writer=r;var d=/\s*/,m=/\s+/,p=/\S/,f=/\s*=/,v=/\s*\}/,$=/#|\^|\/|>|\{|&|=|!/,g=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};c.escape=n,s.prototype.eos=function(){return""===this.tail},s.prototype.scan=function(e){var t=this.tail.match(e);return t&&0===t.index?(this.tail=this.tail.substring(t[0].length),this.pos+=t[0].length,t[0]):""},s.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i),this.pos+=i}return t},o.make=function(e){return e instanceof o?e:new o(e)},o.prototype.clearCache=function(){this._cache={}},o.prototype.push=function(e){return new o(e,this)},o.prototype.lookup=function(e){var t=this._cache[e];if(!t){if("."===e)t=this.view;else for(var i=this;i;){if(e.indexOf(".")>0){var n=e.split("."),s=0;for(t=i.view;t&&n.length>s;)t=t[n[s++]]}else t=i.view[e];if(null!=t)break;i=i.parent}this._cache[e]=t}return"function"==typeof t&&(t=t.call(this.view)),t},r.prototype.clearCache=function(){this._cache={},this._partialCache={}},r.prototype.compile=function(e,t){var i=this._cache[e];if(!i){var n=c.parse(e,t);i=this._cache[e]=this.compileTokens(n,e)}return i},r.prototype.compilePartial=function(e,t,i){var n=this.compile(t,i);return this._partialCache[e]=n,n},r.prototype.compileTokens=function(e,t){var i=a(e),n=this;return function(e,s){if(s)if("function"==typeof s)n._loadPartial=s;else for(var r in s)n.compilePartial(r,s[r]);return i(n,o.make(e),t)}},r.prototype.render=function(e,t,i){return this.compile(e)(t,i)},r.prototype._section=function(e,t,i,n){var s=t.lookup(e);switch(typeof s){case"object":if(g(s)){for(var o="",r=0,a=s.length;a>r;++r)o+=n(this,t.push(s[r]));return o}return s?n(this,t.push(s)):"";case"function":var l=this,u=function(e){return l.render(e,t)},h=s.call(t.view,i,u);return null!=h?h:"";default:if(s)return n(this,t)}return""},r.prototype._inverted=function(e,t,i){var n=t.lookup(e);return!n||g(n)&&0===n.length?i(this,t):""},r.prototype._partial=function(e,t){e in this._partialCache||!this._loadPartial||this.compilePartial(e,this._loadPartial(e));var i=this._partialCache[e];return i?i(t):""},r.prototype._name=function(e,t){var i=t.lookup(e);return"function"==typeof i&&(i=i.call(t.view)),null==i?"":i+""},r.prototype._escaped=function(e,t){return c.escape(this._name(e,t))
},c.parse=function(e,n){function o(){if(x&&!D)for(;C.length;)_.splice(C.pop(),1);else C=[];x=!1,D=!1}if(e=e||"",n=n||c.tags,"string"==typeof n&&(n=n.split(m)),2!==n.length)throw Error("Invalid tags: "+n.join(", "));for(var r,a,p,g,b=h(n),y=new s(e),w=[],_=[],C=[],x=!1,D=!1;!y.eos();){if(r=y.pos,p=y.scanUntil(b[0]))for(var E=0,N=p.length;N>E;++E)g=p.charAt(E),t(g)?C.push(_.length):D=!0,_.push(["text",g,r,r+1]),r+=1,"\n"===g&&o();if(r=y.pos,!y.scan(b[0]))break;if(x=!0,a=y.scan($)||"name",y.scan(d),"="===a)p=y.scanUntil(f),y.scan(f),y.scanUntil(b[1]);else if("{"===a){var T=RegExp("\\s*"+i("}"+n[1]));p=y.scanUntil(T),y.scan(v),y.scanUntil(b[1]),a="&"}else p=y.scanUntil(b[1]);if(!y.scan(b[1]))throw Error("Unclosed tag at "+y.pos);if("/"===a){if(0===w.length)throw Error('Unopened section "'+p+'" at '+r);var F=w.pop();if(F[1]!==p)throw Error('Unclosed section "'+F[1]+'" at '+r)}var k=[a,p,r,y.pos];if(_.push(k),"#"===a||"^"===a)w.push(k);else if("name"===a||"{"===a||"&"===a)D=!0;else if("="===a){if(n=p.split(m),2!==n.length)throw Error("Invalid tags at "+r+": "+n.join(", "));b=h(n)}}var F=w.pop();if(F)throw Error('Unclosed section "'+F[1]+'" at '+y.pos);return l(u(_))};var y=new r;return c.clearCache=function(){return y.clearCache()},c.compile=function(e,t){return y.compile(e,t)},c.compilePartial=function(e,t,i){return y.compilePartial(e,t,i)},c.compileTokens=function(e,t){return y.compileTokens(e,t)},c.render=function(e,t,i){return y.render(e,t,i)},c.to_html=function(e,t,i,n){var s=c.render(e,t,i);return"function"!=typeof n?s:(n(s),void 0)},c}()),i("ui/html",["meems-utils","./widget","mustache"],function(e,t,i){function n(){return this._compiledTemplate=i.compile(""),t.apply(this,arguments),this}return n.extend(t,{attr:function(e,n){return void 0!==n&&"html"===e&&(this._compiledTemplate=i.compile(n||"")),t.prototype.attr.apply(this,arguments)},partialUpdate:function(t){"html"!==t&&"data"!==t||!this.el()||e.Dom.setHtml(this.el(),this._compiledTemplate(this.attr("data")))},update:function(){this.el()||(this.el(document.createElement("div")),e.Dom.addClass(this.el(),"ui-html")),e.Dom.setHtml(this.el(),this._compiledTemplate(this.attr("data"))),t.prototype.update.apply(this,arguments)}}),n}),i("ui/button",["meems-utils","./widget"],function(e,t){function i(){return t.apply(this,arguments),this.$iconEl=null,this.$titleEl=null,this}return i.extend(t,{attr:function(i,n){var s="style"===i?t.prototype.attr.call(this,i):null,o=t.prototype.attr.apply(this,arguments);return"style"===i&&void 0!==n&&this.el()&&(s?e.Dom.removeClass(this.el(),"ui-button-"+s):e.Dom.removeClass(this.el(),"ui-button-normal"),n?e.Dom.addClass(this.el(),"ui-button-"+n):e.Dom.addClass(this.el(),"ui-button-normal")),o},partialUpdate:function(t,i,n){"title"===t&&this.$titleEl?(e.Dom.setHtml(this.$titleEl,this.attr("title")),this.$iconEl.setAttribute("title",this.attr("title")),e.Dom.applyChanges()):"style"===t&&this.el()?(i?e.Dom.removeClass(this.el(),"ui-button-"+i):e.Dom.removeClass(this.el(),"ui-button-normal"),n?e.Dom.addClass(this.el(),"ui-button-"+n):e.Dom.addClass(this.el(),"ui-button-normal")):"icon"===t&&this.$iconEl&&e.Dom.setClass(this.$iconEl,(n?"ui-icon ui-icon-"+n:"ui-no-icon")+(this.attr("disabled")===!0?" ui-disabled":""))},update:function(){this.el()||(this.el(document.createElement("div")),this.$iconEl=document.createElement("div"),this.$iconEl.className="ui-icon",this.$iconEl.setAttribute("title",this.attr("title")||""),this.el().appendChild(this.$iconEl),this.$titleEl=document.createElement("div"),this.$titleEl.className="ui-title",this.el().appendChild(this.$titleEl),e.Dom.addClass(this.el(),"ui-button")),e.Dom.setClass(this.$iconEl,(this.attr("icon")?"ui-icon ui-icon-"+this.attr("icon"):"ui-no-icon")+(this.attr("disabled")===!0?" ui-disabled":"")),e.Dom.setHtml(this.$titleEl,this.attr("title")),this.attr("style",void 0!==this.attr("style")?this.attr("style"):null),t.prototype.update.apply(this,arguments)}}),i}),i("ui/popup_menu",["meems-utils","meems-events","./widget"],function(e,t,i){function n(){return this.$ul=null,this.$items=[],i.apply(this,arguments),this}var s=function(e,t){this.$ul.innerHTML="";for(var i=0,n=t.length;n>i;++i){var s=document.createElement("li");s.innerHTML=t[i].text,s.className="ui-popup-item",this.$ul.appendChild(s)}this.$ul.childNodes.length>0&&(this.$ul.childNodes[0].className+=" ui-popup-item-first",this.$ul.childNodes[this.$ul.childNodes.length-1].className+=" ui-popup-item-last")},o=[],r=!1,a=function(t){for(var i=t.target;i&&(i.className&&-1===i.className.indexOf("ui-popup-item")||!i.className);)i=i.parentNode;if(console.log("target",i),i){var n=i.parentNode.parentNode,s=e.Array.indexOfByProp(o,"$el",n);if(console.log("pos",s),s>-1){var r=o[s],a=Array.prototype.indexOf.call(i.parentNode.childNodes,i),l=r.$items[a],u=l.action;console.log("action",u),u&&u.call(r,l)}}for(var h,c=0,d=o.length;d>c;++c)h=o[c],h.el()&&null!==h.el().parentNode&&h.$lastShow&&(new Date).getTime()-h.$lastShow.getTime()>500&&(document.body.removeChild(h.el()),h.$lastShow=null,o.splice(c,0),--d,--c)};return n.extend(i,{items:function(e){return void 0===e?this.$items:(s.call(this,this.$items,e),this.$items=e,this)},isVisible:function(){return null!==this.el().parentNode},hide:function(){return null!==this.el().parentNode&&(document.body.removeChild(this.el()),this.$lastShow=null,e.Array.remove(o,this)),this},show:function(t,i,n,s){var r=e.Dom.getRect(t),a=r.x,l=r.y,u="left",h="top";return i.indexOf("below")>-1&&(l=r.y+r.height),i.indexOf("right")>-1&&(a=document.body.clientWidth-r.x-r.width,u="right"),a+=n||0,l+=s||0,this.el().style[u]=a+"px",this.el().style[h]=l+"px",document.body.appendChild(this.el()),this.$lastShow=new Date,o.push(this),this},update:function(){this.el()||(this.el(document.createElement("div")),this.$ul=document.createElement("ul"),this.el().appendChild(this.$ul),this.el().className="ui-popup-menu","function"==typeof this.$items&&"subscribe"in this.$items&&this.$items.subscribe(e.Fn.bind(s,this)),r||(t.Dom.on(document,t.Touch.touchEndEventName,a),r=!0)),i.prototype.update.apply(this,arguments)}}),n}),i("ui/button_group",["meems-utils","./widget","./button","./popup_menu"],function(e,t,i,n){function s(){return t.apply(this,arguments),this.$buttons=[],this.$overflow=null,this.$popupMenu=null,this}var o=function(t,i){for(var n=i.target;n&&(n.className&&-1===n.className.indexOf("ui-button")||!n.className);)n=n.parentNode;if(n)if(n===this.$overflow.el())a.call(this);else{var s=e.Array.indexOfByProp(this.$buttons,"$el",n);s>-1&&this.fire("button:pressed",this.$buttons[s])}},r=function(t){if(this.el()){var i,n=this.el(),s=this.attr("stretch")===!0,r=this.$buttons.length>0?100/this.$buttons.length:0,a=void 0!==this.attr("selected")?this.attr("selected"):-1,l=Math.min(this.attr("maxButtons")||9999,this.$buttons.length);this.$buttons.length>l&&--l,this.$overflow.el().parentNode===n&&n.removeChild(this.$overflow.el());for(var u=0;l>u;++u)i=this.$buttons[u],i.update(t),i.el().parentNode!==n&&(n.appendChild(i.el()),i.on("dom:"+(e.Dom.supportsTouch()?"touchstart":"click"),e.Fn.bind(o,this))),i.el().style.width=s?r+"%":"",a===u?e.Dom.addClass(i.el(),"ui-selected"):e.Dom.removeClass(i.el(),"ui-selected");for(var u=l;this.$buttons.length>u;++u)i=this.$buttons[u],i.el()&&i.el().parentNode===n&&n.removeChild(i.el());l!==this.$buttons.length?this.$overflow.el().parentNode!==n&&n.appendChild(this.$overflow.el()):this.$overflow.el().parentNode===n&&n.removeChild(this.$overflow.el())}},a=function(){if(this.$popupMenu.isVisible())return this.$popupMenu.hide(),void 0;var e=Math.min(this.attr("maxButtons")||9999,this.$buttons.length);this.$buttons.length>e&&--e;for(var t,i=[],n=e,s=this.$buttons.length;s>n;++n)t=this.$buttons[n],i.push({text:t.attr("title"),action:function(e,t){return function(){e.fire("button:pressed",t)}}(this,t)});this.$popupMenu.items(i),this.$popupMenu.show(this.$overflow.el(),"below-right-aligned",0,5)};return s.extend(t,{addButton:function(e){return this.$buttons.push(e),this},buttons:function(e){if(void 0===e)return this.$buttons;if(this.$buttons&&this.$buttons.length>0){var t,i;for(i=0;this.$buttons.length>i;++i)t=this.$buttons[i],t.el()&&t.el().parentNode===this.el()&&this.el().removeChild(t.el())}return this.$buttons=e,r.call(this),this},update:function(s){this.el()||(this.el(document.createElement("div")),e.Dom.addClass(this.el(),"ui-button-group"),this.$overflow=(new i).attr("icon","overflow").attr("title","More"),this.$overflow.update(),this.$overflow.on("dom:"+(e.Dom.supportsTouch()?"touchstart":"click"),e.Fn.bind(o,this)),this.$popupMenu=new n,this.$popupMenu.update()),r.call(this,s),t.prototype.update.apply(this,arguments)}}),s}),i("ui/list",["meems-utils","meems-events","./widget","./html"],function(e,t,i,n){function s(){return i.apply(this,arguments),this.$header=!1,this.$table=null,this.$leftFacet=null,this.$rightFacet=null,this.$middleFacet=null,this.$orderButton=null,this.$dragging=!1,this.$cursorStartPosition=null,this.$elementStartPosition=null,this.facet("item",null),this.$onItemMoved=e.Fn.bind(a,this),this.$onEndOrdering=e.Fn.bind(l,this),this}function o(){return i.apply(this,arguments),this.$generatedItems=[],this.$items=[],this.$template="{{text}}",this.$headerTemplate="{{text}}",this.$placeHolder=null,this.$empty=null,this.$selectedItems=[],this.attr("style","normal"),this.attr("sortable",!1),this.attr("selectionMode","single"),this}var r=function(i){if(!this.$dragging){var n=this.el(),s=this.parent(),o=s.el(),r=s.$placeHolder;this.$dragging=!0,t.Dom.on(document,t.Touch.touchMoveEventName,this.$onItemMoved),t.Dom.on(document,t.Touch.touchEndEventName,this.$onEndOrdering),this.$elementStartPosition=e.Dom.getAbsolutePosition(n),n.style.top=this.$elementStartPosition.y+"px";var a=e.Dom.getDimensions(n);return n.style.width=a.width+"px",n.style.height=a.height+"px",r.className=n.className,r.style.width=a.width+"px",r.style.height=a.height+"px",this.$cursorStartPosition=t.Touch.getCursorPosition(i),this.$elementStartPosition=e.Dom.getAbsolutePosition(n),e.Dom.addClass(n,"ui-list-item-drag"),e.Dom.applyChanges(),o.insertBefore(r,n),t.Dom.cancelEvent(i)}},a=function(e){if(this.$dragging){var i,n,s=this.el(),o=this.parent(),r=o.el(),a=o.$placeHolder,l=t.Touch.getCursorPosition(e),u=r.children,h=null;l.y+=this.$elementStartPosition.y-this.$cursorStartPosition.y,s.style.top=l.y+"px";for(var c=l.y+s.offsetHeight/2,d=0,m=u.length;m>d;++d)if(n=u[d],n!==s){if(i=n.offsetHeight,i/2>=c){h=n;break}c-=i}return h===a?t.Dom.cancelEvent(e):(h?r.insertBefore(a,h):r.appendChild(a),void 0)}},l=function(i){if(this.$dragging){var n=this.el(),s=this.parent(),o=s.el(),r=s.$placeHolder;e.Dom.removeClass(n,"ui-list-item-drag"),n.style.top="",n.style.width="",n.style.height="",t.Dom.off(document,t.Touch.touchMoveEventName,this.$onItemMoved),t.Dom.off(document,t.Touch.touchEndEventName,this.$onEndOrdering),e.Dom.applyChanges(),o.replaceChild(n,r);var a=s.$generatedItems.indexOf(this),l=Array.prototype.indexOf.call(o.children,n);e.Array.moveElement(s.$generatedItems,a,l);var u=s.items();return u="function"==typeof u?u():u,e.Array.moveElement(u,a,l),"function"==typeof s.items().notify&&s.items().notify(u,u),this.$dragging=!1,h.call(s),t.Dom.cancelEvent(i)}};s.extend(i,{header:function(t){return void 0===t?this.$header:(this.$header=t,this.el()&&(this.$header?(e.Dom.addClass(this.el(),"ui-list-header"),e.Dom.removeClass(this.el(),"ui-list-item")):(e.Dom.addClass(this.el(),"ui-list-item"),e.Dom.removeClass(this.el(),"ui-list-header"))),this)},update:function(){var n="multiple"===this.parent().attr("selectionMode"),s=this.parent().attr("sortable")===!0;if(!this.el()){if(this.el(document.createElement("li")),n||s){this.$table=document.createElement("table"),this.$table.className="ui-fill-width",this.$leftFacet=document.createElement("td"),this.$middleFacet=document.createElement("td"),this.$middleFacet.className="ui-fill-width",this.$rightFacet=document.createElement("td");var o=document.createElement("input");o.setAttribute("type","checkbox"),o.className="meems-scroll-skip",t.Dom.on(o,"change",e.Fn.bind(function(){this.parent().fire("item:checked",this,o.checked)},this)),this.$leftFacet.appendChild(o),this.$orderButton=document.createElement("div"),this.$orderButton.className="ui-icon-order meems-scroll-skip",t.Dom.on(this.$orderButton,t.Touch.touchStartEventName,e.Fn.bind(r,this)),this.$rightFacet.appendChild(this.$orderButton);var a=document.createElement("tr");a.appendChild(this.$leftFacet),a.appendChild(this.$middleFacet),a.appendChild(this.$rightFacet),this.$table.appendChild(a),this.$leftFacet.style.display=n?"":"none",this.$rightFacet.style.display=s?"":"none",this.el().appendChild(this.$table)}else this.$middleFacet=this.el();this.header(this.$header)}this.facet("item")&&(this.facet("item").update(),this.facet("item").el().parentNode!==this.$middleFacet&&this.$middleFacet.appendChild(this.facet("item").el())),i.prototype.update.apply(this,arguments)}});var u=function(e,t){var i=new s;return i.parent(this),i.header(e.header===!0),i.header()?i.facet("item",(new n).attr("html",this.$headerTemplate).attr("data",e)):i.facet("item",(new n).attr("html",this.$template).attr("data",e)),i.update(),i.el()._meems_parentList=this,i.el()._meems_item_index=t,i.el()._meems_item=e,i},h=function(){var t,i,n;if(this.$generatedItems){for(i=0,n=this.$generatedItems.length;n>i;++i)t=this.$generatedItems[i],t.header()||(n-1>i?this.$generatedItems[i+1].header()?e.Dom.addClass(t.el(),"ui-list-item-last"):e.Dom.removeClass(t.el(),"ui-list-item-last"):e.Dom.addClass(t.el(),"ui-list-item-last"));e.Dom.applyChanges()}},c=function(t,i){if(this.el()){i="function"==typeof i?i():i;var n,s,o,r,a,l,h=this.el(),c={},d=h.parentNode,m=0;if(d&&(m=Array.prototype.indexOf.call(d.childNodes,h),d.removeChild(h),console.log("remove list parent")),this.$generatedItems)for(o=0,r=this.$generatedItems.length;r>o;++o){n=this.$generatedItems[o];var p=!1;for(a=0,l=i.length;l>a;++a)if(n.el()._meems_item===i[a]){p=!0,c[a]=o,e.Dom.removeClass(n.el(),"ui-list-item-last"),h.removeChild(n.el());break}if(!p&&n.el()&&n.el().parentNode===h){h.removeChild(n.el()),this.$generatedItems.splice(o,1);var f=this.$selectedItems.indexOf(n);f>-1&&this.$selectedItems.splice(f,1),--o,--r}}for(o=0,r=i.length;r>o;++o)s=i[o],void 0===c[o]?(n=u.call(this,s,o,r),this.$generatedItems.splice(o,0,n)):n=this.$generatedItems[c[o]],h.appendChild(n.el()),n.header()||(r-1>o?i[o+1].header===!0?e.Dom.addClass(n.el(),"ui-list-item-last"):e.Dom.removeClass(n.el(),"ui-list-item-last"):e.Dom.addClass(n.el(),"ui-list-item-last"));this.$emptyIsVisible||0!=this.$generatedItems.length?this.$emptyIsVisible&&this.$generatedItems.length>0&&(h.removeChild(this.$empty),this.$emptyIsVisible=!1):(h.appendChild(this.$empty),this.$emptyIsVisible=!0),d&&(d.insertBefore(h,d.childNodes[m]),console.log("inserted list parent"))}},d=function(e,t){for(var i=t.target;i&&void 0===i._meems_item_index;)i=i.parentNode;return i&&this.fire("item:clicked",i._meems_item,t),!0};return o.extend(i,{template:function(e){return void 0===e?this.$template:(this.$template=e,this)},headerTemplate:function(e){return void 0===e?this.$headerTemplate:(this.$headerTemplate=e,this)},items:function(t){return void 0===t?this.$items:(this.$items=t,c.call(this,null,this.$items),"function"==typeof this.$items.subscribe&&this.$items.subscribe(e.Fn.bind(c,this)),this)},attr:function(t,n){var s="style"===t?i.prototype.attr.call(this,t):null,o=i.prototype.attr.apply(this,arguments);return"style"===t&&void 0!==n&&this.el()?(s&&e.Dom.removeClass(this.el(),"ui-list-"+s),n&&e.Dom.addClass(this.el(),"ui-list-"+n)):"empty"===t&&this.$empty&&e.Dom.setHtml(this.$empty,n),o},getSelectedItems:function(){return this.$selectedItems},update:function(n){this.el()||(this.el(document.createElement("ul")),this.el().className="ui-list",this.on("dom:"+t.Touch.touchEndEventName,e.Fn.bind(d,this)),this.$placeHolder=document.createElement("li"),this.$placeHolder.className="ui-list-item ui-list-placeholder",this.$empty=document.createElement("li"),this.$empty.className="ui-list-empty",this.$empty.innerHTML=this.attr("empty")||"No data.",this.el().appendChild(this.$empty),this.$emptyIsVisible=!0,this.on("item:checked",function(e,t,i){i?this.$selectedItems.push(t.el()._meems_item):this.$selectedItems.splice(this.$selectedItems.indexOf(t.el()._meems_item),1),this.fire("selection:changed",this.$selectedItems)})),n!==!0&&(this.attr("style",this.attr("style")),c.call(this,null,this.$items)),i.prototype.update.apply(this,arguments)}}),o}),i("ui/aside",["meems-utils","./widget"],function(e,t){function i(){return t.apply(this,arguments),this.$expanded=!1,this.facet("menu",null),this.facet("content",null),this}return i.extend(t,{expanded:function(t){return void 0===t?this.$expanded:(this.$expanded=t,this.$expanded?(this.facet("menu")&&(e.Dom.addClass(this.facet("menu").el(),"ui-expanded"),e.Dom.removeClass(this.facet("menu").el(),"ui-collapsed")),this.facet("content")&&(e.Dom.addClass(this.facet("content").el(),"ui-expanded"),e.Dom.removeClass(this.facet("content").el(),"ui-collapsed"))):(this.facet("menu")&&(e.Dom.addClass(this.facet("menu").el(),"ui-collapsed"),e.Dom.removeClass(this.facet("menu").el(),"ui-expanded")),this.facet("content")&&(e.Dom.addClass(this.facet("content").el(),"ui-collapsed"),e.Dom.removeClass(this.facet("content").el(),"ui-expanded"))),this)},update:function(i){this.el()||(this.el(document.createElement("div")),e.Dom.addClass(this.el(),"ui-aside")),this.facet("menu")&&(this.facet("menu").update(i),e.Dom.addClass(this.facet("menu").el(),"ui-aside-menu"),this.facet("menu").el().parentNode!==this.el()&&this.el().appendChild(this.facet("menu").el())),this.facet("content")&&(this.facet("content").update(i),e.Dom.addClass(this.facet("content").el(),"ui-aside-content"),this.facet("content").el().parentNode!==this.el()&&(e.Dom.addClass(this.facet("content").el(),"ui-content ui-scroll-y"),this.el().appendChild(this.facet("content").el()))),this.expanded(this.$expanded),t.prototype.update.apply(this,arguments)}}),i}),i("ui/split_view",["meems-utils","./widget"],function(e,t){function i(){return t.apply(this,arguments),this.attr("layout","horizontal"),this.facet("first",null),this.facet("second",null),this}return i.extend(t,{attr:function(i,n){var s="layout"===i?t.prototype.attr.call(this,i):null,o=t.prototype.attr.apply(this,arguments);return"layout"===i&&void 0!==n&&this.el()&&(s&&e.Dom.removeClass(this.el(),"ui-"+s),n&&e.Dom.addClass(this.el(),"ui-"+n)),o},update:function(e){this.el()||(this.el(document.createElement("div")),this.el().className="ui-splitview",this.attr("layout",this.attr("layout"))),this.facet("first")&&(this.facet("first").update(e),this.facet("first").el().parentNode!==this.el()&&this.el().appendChild(this.facet("first").el())),this.facet("second")&&(this.facet("second").update(e),this.facet("second").el().parentNode!==this.el()&&this.el().appendChild(this.facet("second").el())),t.prototype.update.apply(this,arguments)}}),i}),i("ui/tab",["meems-utils","meems-scroll","./widget"],function(e,t,i){function n(){return i.apply(this,arguments),this.$scroller=null,this.$holder=null,this.facet("content",null),this}return n.extend(i,{update:function(e){this.el()||(this.el(document.createElement("div")),this.el().className="ui-tab");var n=this.facet("content");n&&(n.update(e),this.$holder||(this.$holder=document.createElement("div"),this.$holder.className="ui-fill-width",this.el().appendChild(this.$holder)),n.el().parentNode!==this.$holder&&(this.$holder.appendChild(n.el()),this.$scroller&&this.$scroller.destroy(),this.$scroller=new t(this.el(),{scrollX:!1,scrollY:!0}))),i.prototype.update.apply(this,arguments)}}),n}),i("ui/tab_group",["meems-utils","meems-scroll","./widget","./tab","./button_group","./button"],function(e,t,i,n,s,o){function r(){return i.apply(this,arguments),this.$tabs=[],this.$visibleTab=0,this.$scroller=null,this.$tabHolder=null,this.$buttonGroup=null,this}var a=function(t,i){for(var n=i.target;n&&-1===n.className.indexOf("ui-button");)n=n.parentNode;if(n){var s=e.Array.indexOfByProp(this.$buttonGroup.buttons,"$el",n);s>-1&&this.visibleTab(s)}},l=function(t,i){var n=Math.round(i/this.el().offsetWidth);this.visibleTab(n),this.update(),e.Dom.applyChanges()};return r.extend(i,{addTab:function(e){return this.$tabs.push(e),this},visibleTab:function(e){return void 0===e?this.$visibleTab:0>e||e>=this.$tabs.length?this:(e!==this.$visibleTab&&this.$scroller&&(this.$scroller.scrollTo(e*this.el().offsetWidth),this.$visibleTab=e),this)},tabs:function(){return this.$tabs},partialUpdate:function(t,i,n){"tabPosition"===t&&this.el()&&(e.Dom.removeClass(this.el(),"ui-tab-buttons-"+i),e.Dom.addClass(this.el(),"ui-tab-buttons-"+n))},update:function(n){if(!this.el()){this.el(document.createElement("div")),this.el().className="ui-tab-group",this.$tabHolder=document.createElement("div"),this.$helperHolder=document.createElement("div"),this.$buttonGroup=document.createElement("div"),this.$tabHolder.className="ui-fill",this.$helperHolder.className="ui-tab-holder ui-fill",this.$buttonGroup.className="ui-tab-buttons",this.$buttonGroup.buttons=[],this.$helperHolder.appendChild(this.$tabHolder),this.el().appendChild(this.$helperHolder);var s=this.attr("tabPosition")||"top";this.el().className+="top"===s?" ui-tab-buttons-top":" ui-tab-buttons-bottom",this.el().appendChild(this.$buttonGroup)}if(this.$tabs.length>0){var r,u,h=100/this.$tabs.length;this.$tabHolder.style.width=100*this.$tabs.length+"%";for(var c=0,d=this.$tabs.length;d>c;++c)r=this.$tabs[c],r.update(n),r.el().parentNode!==this.$tabHolder&&(r.el().style.position="absolute",r.el().style.left=c*h+"%",r.el().style.top="0",r.el().style.width=h+"%",r.el().style.bottom="0",this.$tabHolder.appendChild(r.el()),u=(new o).attr("style","vertical"),u.update(n),u.on("dom:"+(e.Dom.supportsTouch()?"touchstart":"click"),e.Fn.bind(a,this)),this.$buttonGroup.appendChild(u.el()),this.$buttonGroup.buttons.push(u)),u=u||this.$buttonGroup.buttons[c],u.attr("title",r.attr("title")).attr("icon",r.attr("icon")).attr("disabled",this.$visibleTab!==c),u.update(n),u.el().style.width=h+"%",c===this.$visibleTab?e.Dom.addClass(u.el(),"ui-selected"):e.Dom.removeClass(u.el(),"ui-selected"),u=null;e.Dom.addClass(this.$tabHolder,"ui-footer-on"),this.$scroller||(this.$scroller=new t(this.$helperHolder,{scrollX:!0,scrollY:!1,bouncing:!1,paging:!0,totalMaxTime:.25,disableTouchEvents:!1,hideScroller:!0}).on("scroll:end",e.Fn.bind(l,this)))}else e.Dom.addClass(this.$tabHolder,"ui-footer-off");i.prototype.update.apply(this,arguments)}}),r}),i("ui/form",["meems-utils","./widget"],function(e,t){function i(){return t.apply(this,arguments),this.$titleEl=null,this.$holder=null,this.$fields=[],this}return i.extend(t,{addField:function(e){return this.$fields.push(e),this},fields:function(e){return void 0===e?this.$fields:(this.$fields=e,this)},partialUpdate:function(t,i,n){"action"===t&&this.el()?this.el().setAttribute("action",n||"#"):"title"===t&&this.$titleEl&&(e.Dom.setHtml(this.$titleEl,n),n.length>0?(e.Dom.addClass(this.$titleEl,"ui-show"),e.Dom.removeClass(this.$titleEl,"ui-hide")):(e.Dom.addClass(this.$titleEl,"ui-hide"),e.Dom.removeClass(this.$titleEl,"ui-show")))},update:function(i){this.el()||(this.el(document.createElement("form")),this.el().className="ui-form",this.el().setAttribute("action",this.attr("action")||"#"),this.$titleEl=document.createElement("div"),this.$titleEl.className="ui-title",this.el().appendChild(this.$titleEl),this.$holder=document.createElement("div"),this.$holder.className="ui-form-fields",this.el().appendChild(this.$holder));var n=this.attr("title")||"";e.Dom.setHtml(this.$titleEl,n),n.length>0?(e.Dom.addClass(this.$titleEl,"ui-show"),e.Dom.removeClass(this.$titleEl,"ui-hide")):(e.Dom.addClass(this.$titleEl,"ui-hide"),e.Dom.removeClass(this.$titleEl,"ui-show"));for(var s,o=0;this.$fields.length>o;++o)s=this.$fields[o],s.update(i),s.el().parentNode!==this.$holder&&this.$holder.appendChild(s.el());t.prototype.update.apply(this,arguments)}}),i}),i("ui/textfield",["meems-utils","meems-events","./widget"],function(e,t,i){function n(){return this.$input=null,this.$label=null,this.$value=null,i.apply(this,arguments),this}var s=function(e,t){this.$input&&(this.$input.value=t)};return n.extend(i,{value:function(e){return void 0===e?"function"==typeof this.$value?this.$value:this.$input.value:(this.$value=e,s.call(this,null,e),this)},partialUpdate:function(t,i,n){"label"===t&&this.$label&&e.Dom.setHtml(this.$label,n||"")},update:function(){if(!this.el()){this.el(document.createElement("div")),this.$label=document.createElement("label"),this.$input=document.createElement("input"),this.$input.setAttribute("type",this.attr("type")||"text"),this.el().appendChild(this.$label);var n=document.createElement("div");n.appendChild(this.$input),this.el().appendChild(n),this.el().className="ui-textfield",t.Dom.on(this.$input,"change",e.Fn.bind(function(){"function"==typeof this.$value&&this.$value(this.$input.value)},this)),t.Dom.on(this.$input,"focus",e.Fn.bind(function(){e.Dom.addClass(this.el(),"ui-focused"),e.Dom.applyChanges()},this)),t.Dom.on(this.$input,"blur",e.Fn.bind(function(){e.Dom.removeClass(this.el(),"ui-focused"),e.Dom.applyChanges()},this)),"function"==typeof this.$value&&"subscribe"in this.$value&&this.$value.subscribe(s)}e.Dom.setHtml(this.$label,this.attr("label")||""),i.prototype.update.apply(this,arguments)}}),n}),i("ui/page_holder",["meems-utils","./widget","./page"],function(e,t){function i(){return t.apply(this,arguments),this.$pages=[],this.$currentPage=null,this}return i.extend(t,{pages:function(e){if(void 0===e)return this.$pages;var t,i,n;if(this.$pages)for(i=0,n=this.$pages.length;n>i;++i)t=this.$pages[i],t.el()&&t.el().parentNode===this.el()&&this.el().removeChild(t.el());if(this.$pages=e,this.$pages)for(i=0,n=this.$pages.length;n>i;++i)t=this.$pages[i],t.el()&&t.el().parentNode!==this.el()&&this.el().appendChild(t.el());return this},currentPage:function(t){return void 0===t?this.$currentPage:(this.$currentPage&&(e.Dom.removeClass(this.$currentPage.el(),"ui-show"),e.Dom.addClass(this.$currentPage.el(),"ui-hide")),this.$currentPage=t,this.$currentPage&&(e.Dom.removeClass(this.$currentPage.el(),"ui-hide"),e.Dom.addClass(this.$currentPage.el(),"ui-show")),this)},update:function(i){if(this.el()||(this.el(document.createElement("div")),this.el().className="ui-page-holder"),this.$pages)for(var n,s=0,o=this.$pages.length;o>s;++s)n=this.$pages[s],n.update(i),n.el()&&n.el().parentNode!==this.el()&&this.el().appendChild(n.el()),this.$currentPage||(this.$currentPage=n),n.el()&&(this.$currentPage===n?(e.Dom.removeClass(this.$currentPage.el(),"ui-hide"),e.Dom.addClass(this.$currentPage.el(),"ui-show")):(e.Dom.addClass(n.el(),"ui-hide"),e.Dom.removeClass(n.el(),"ui-show")));t.prototype.update.apply(this,arguments)}}),i}),i("ui/group",["meems-utils","./widget"],function(e,t){function i(){return t.apply(this,arguments),this.$children=[],this}return i.extend(t,{children:function(e){if(void 0===e)return this.$children;var t,i,n;if(this.$children)for(i=0,n=this.$children.length;n>i;++i)t=this.$children[i],t.el().parentNode===this.el()&&this.el().removeChild(t.el());this.$children=e;for(var i=0,n=this.$children.length;n>i;++i)t=this.$children[i],t.el()&&t.el().parentNode!==this.el()&&this.el().appendChild(t.el());return this},appendChild:function(e){return this.$children.push(e),this.el()&&e.el()&&e.el().parentNode!==this.el()&&this.el().appendChild(e.el()),this},removeChild:function(t){return e.Array.remove(this.$children,t),this.el()&&t.el()&&t.el().parentNode===this.el()&&this.el().removeChild(t.el()),this},update:function(e){this.el()||(this.el(document.createElement("div")),this.el().className="ui-group");for(var i,n=0,s=this.$children.length;s>n;++n)i=this.$children[n],i.update(e),i.el().parentNode!==this.el()&&this.el().appendChild(i.el());t.prototype.update.apply(this,arguments)}}),i}),i("ui/switch",["meems-utils","meems-events","./widget"],function(e,t,i){function n(){return this.$input=null,this.$label=null,this.$value=!1,i.apply(this,arguments),this}var s=function(e,t){var i="function"==typeof t?t():t;this.$input&&(this.$input.checked=i)};return n.extend(i,{value:function(e){return void 0===e?this.$value:(s.call(this,this.$value,e),this.$value=e,this)},partialUpdate:function(t,i,n){"label"===t&&this.$label&&e.Dom.setHtml(this.$label,n||"")},update:function(){if(!this.el()){this.el(document.createElement("div")),this.$label=document.createElement("label"),this.$input=document.createElement("input"),this.$inputLabel=document.createElement("label"),this.$inputLabel.appendChild(document.createElement("b")),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("checked","checkbox");var n=document.createElement("div");s.call(this,null,this.$value),n.appendChild(this.$input),n.appendChild(this.$inputLabel),this.el().appendChild(this.$label),this.el().appendChild(n),this.el().className="ui-switch",t.Dom.on(n,t.Touch.touchEndEventName,e.Fn.bind(function(){if("function"==typeof this.$value){var t=!this.$value();this.$input.checked=t,this.$value(t)}else s.call(this,this.$value,!this.$value),this.$value=!this.$value,this.$input.checked=this.$value;e.Dom.applyChanges()},this)),"function"==typeof this.$value&&"subscribe"in this.$value&&this.$value.subscribe(e.Fn.bind(s,this))}e.Dom.setHtml(this.$label,this.attr("label")||""),i.prototype.update.apply(this,arguments)}}),n}),i("ui/slider",["meems-utils","meems-events","./widget"],function(e,t,i){function n(){return this.$input=null,this.$label=null,this.$value=!1,i.apply(this,arguments),this}var s=function(e,t){var i="function"==typeof t?t():t;if(this.$input){var n=this.attr("minimum")||0,s=this.attr("maximum")||100,o=100*Math.max(Math.min((i-n)/(s-n),1),0);this.$inputBar.style.width=o+"%",this.$inputHandle.style.left=o+"%"}},o=function(i){this.$meems_ui_slider_move&&t.Dom.off(this.$input,t.Touch.touchMoveEventName,this.$meems_ui_slider_move),this.$meems_ui_slider_end&&t.Dom.off(this.$input,t.Touch.touchEndEventName,this.$meems_ui_slider_end),this.$meems_ui_slider_start_pos=t.Touch.getCursorPosition(i),this.$meems_ui_slider_pos=e.Dom.getAbsolutePosition(this.$input),this.$meems_ui_slider_size=e.Dom.getDimensions(this.$input);var n=this.$meems_ui_slider_start_pos.x-this.$meems_ui_slider_pos.x,o=Math.min(Math.max(n/this.$meems_ui_slider_size.width,0),1),l=this.attr("minimum")||0,u=this.attr("maximum")||100;return o=o*(u-l)+l,"function"==typeof this.$value?this.$value(o):(this.$value=o,s.call(this,null,o)),this.$meems_ui_slider_move=e.Fn.bind(r,this),this.$meems_ui_slider_end=e.Fn.bind(a,this),t.Dom.on(this.$input,t.Touch.touchMoveEventName,this.$meems_ui_slider_move),t.Dom.on(this.$input,t.Touch.touchEndEventName,this.$meems_ui_slider_end),e.Dom.applyChanges(),t.Dom.cancelEvent(i)},r=function(e){var i=t.Touch.getCursorPosition(e),n=i.x-this.$meems_ui_slider_pos.x,o=Math.min(Math.max(n/this.$meems_ui_slider_size.width,0),1),r=this.attr("minimum")||0,a=this.attr("maximum")||100;return o=o*(a-r)+r,"function"==typeof this.$value?this.$value(o):(this.$value=o,s.call(this,null,o)),t.Dom.cancelEvent(e)},a=function(){t.Dom.off(this.$input,t.Touch.touchMoveEventName,this.$meems_ui_slider_move),t.Dom.off(this.$input,t.Touch.touchEndEventName,this.$meems_ui_slider_end),this.$meems_ui_slider_end=null,this.$meems_ui_slider_move=null};return n.extend(i,{value:function(e){return void 0===e?this.$value:(s.call(this,this.$value,e),this.$value=e,this)},partialUpdate:function(t,i,n){"label"===t&&this.$label&&e.Dom.setHtml(this.$label,n||"")},update:function(){this.el()||(this.el(document.createElement("div")),this.$label=document.createElement("label"),this.$inputBar=document.createElement("div"),this.$inputBar.className="ui-bar",this.$inputHandle=document.createElement("div"),this.$inputHandle.className="ui-handle",this.$input=document.createElement("div"),s.call(this,null,this.$value),this.$input.appendChild(this.$inputBar),this.$input.appendChild(this.$inputHandle),this.el().appendChild(this.$label),this.el().appendChild(this.$input),this.el().className="ui-slider",t.Dom.on(this.$input,t.Touch.touchStartEventName,e.Fn.bind(o,this)),"function"==typeof this.$value&&"subscribe"in this.$value&&this.$value.subscribe(e.Fn.bind(s,this))),e.Dom.setHtml(this.$label,this.attr("label")||""),i.prototype.update.apply(this,arguments)
}}),n}),i("meems-ui",["./observable","./ui/widget","./ui/header","./ui/footer","./ui/page","./ui/html","./ui/button","./ui/button_group","./ui/list","./ui/aside","./ui/split_view","./ui/tab_group","./ui/tab","./ui/form","./ui/textfield","./ui/page_holder","./ui/group","./ui/switch","./ui/slider","./ui/popup_menu"],function(e,t,i,n,s,o,r,a,l,u,h,c,d,m,p,f,v,$,g,b){var y={header:i,footer:n,page:s,html:o,button:r,buttongroup:a,list:l,aside:u,splitview:h,tabgroup:c,tab:d,form:m,textfield:p,pageholder:f,group:v,"switch":$,slider:g,popupmenu:b},w={create:function(e,t){var i=y[e]?new y[e]:null;return i&&t&&i.parent(t),i},registerWidget:function(e,t){y[e]=t}};return w}),i("router",["meems-events"],function(e){function t(e){for(var t,i,s=0,o=n.length;o>s;++s)if(t=n[s],i=t.route.exec(e)){for(var r={},a=0,l=t.params.length;l>a;++a)r[t.params[a]]=i[a+1];return{callback:t.callback,params:r}}return null}function i(){o.goTo(window.location.hash.replace(/^#\/?/,""),!0)}var n=[],s=/\/([:\?])([\w\d]+)/g,o={get:function(){return window.location.hash.replace(/^#\/?/,"")},on:function(e,t){var i=[];s.lastIndex=0;var o=e.replace(s,function(e,t,n){return i.push(n),":"===t?"/([^/]+)":"(?:/([^/]+))?"}),r={route:RegExp(o),params:i,callback:t};n.push(r)},goTo:function(e,i){if(i!==!0)window.location.hash="#"+e;else{var n=t(e);n&&n.callback({url:e,params:n.params})}},init:function(){o.goTo(o.get(),!0)}};return function(){if("onhashchange"in window)e.Dom.on(window,"hashchange",i);else{var t=window.location.hash;window.setInterval(function(){t!==window.location.hash&&(i(),t=window.location.hash)},250)}}(),o}),i("meems",["./observable","./meems-ui","meems-events","meems-utils","meems-scroll","./router"],function(e,t,i,n,s,o){var r={Observable:e,UI:t,Events:i,Utils:n,Scroll:s,Router:o};return r}),t("meems")}),s("view/login",["meems"],function(e){function t(){var e=s.observable("RSS Reader"),t=s.observable(""),o=s.observable(""),r=i.create("page").attr("enableScroll",!1).facet("header",i.create("header").attr("title",e).facet("buttonsright",i.create("buttongroup").addButton(i.create("button").attr("title","Login").attr("icon","accept").on("dom:"+n.Touch.touchEndEventName,function(){r.fire("login")})))).facet("content",i.create("form").addField(i.create("textfield").attr("label","Email").attr("type","email").value(t)).addField(i.create("textfield").attr("label","Password").attr("type","password").value(o)));return this.ui=r,this.username=t,this.password=o,this}var i=e.UI,n=e.Events,s=e.Observable;return t}),s("view/feeds",["meems"],function(e){function t(e){var t='<div class="feed"><div class="icon">{{#icon}}<img src="{{icon}}">{{/icon}}</div><div class="name">{{name}}</div><div class="summary">{{summary}}</div><div class="clear"></div></div>',r=o.observableArray([]),a=o.observableArray([]),l="Feeds",u=i.create("list").items(a).template(t).attr("style","normal").attr("sortable",!0).attr("selectionMode","multiple").on("item:clicked",function(){return!0}).on("selection:changed",function(e,t){t.length>0?f.facet("footer",h).update(!0):f.facet("footer",null).update(!0),n.Dom.applyChanges()}),h=i.create("footer").facet("buttons",i.create("buttongroup").buttons([i.create("button").attr("action","delete").attr("style","icon").attr("title","Delete").attr("icon","delete")]).on("button:pressed",function(e,t){var i=t.attr("action");"delete"===i&&(a.removeAll(u.getSelectedItems()),u.update(),n.Dom.applyChanges())})),c=o.observable("refresh"),d=i.create("pageholder",e),m=i.create("page",d).attr("enableScroll",!0).facet("header",i.create("header").attr("title",l).facet("buttonsright",i.create("buttongroup").addButton(i.create("button").attr("title","Manage").attr("icon","add").attr("action","manage")).addButton(i.create("button").attr("title","Refresh").attr("icon",c).attr("action","refresh")).on("button:pressed",function(e,t){switch(t.attr("action")){case"manage":m.fire("feeds:manage"),d.currentPage(f),n.Dom.applyChanges();break;case"refresh":c("loading"),n.Dom.applyChanges(),m.fire("feeds:refresh",function(){c("refresh"),n.Dom.applyChanges()})}}))).facet("content",i.create("list").items(r).template(t).attr("style","normal").on("item:clicked",function(e,t){return d.fire("feeds:clicked",t),!0})),p=o.observable(""),f=i.create("page",d).attr("enableScroll",!0).facet("header",i.create("header").attr("title",l).facet("buttonsleft",i.create("buttongroup").addButton(i.create("button").attr("title","Back").attr("icon","back").attr("action","back")).on("button:pressed",function(e,t){switch(t.attr("action")){case"back":f.fire("feeds:cancel",function(e){e&&(d.currentPage(m),n.Dom.applyChanges())})}})).facet("buttonsright",i.create("buttongroup").addButton(i.create("button").attr("title","Save").attr("icon","save").attr("action","save")).on("button:pressed",function(e,t){switch(t.attr("action")){case"save":f.fire("feeds:save",function(e){e&&(d.currentPage(m),n.Dom.applyChanges())})}}))).facet("content",i.create("group").attr("customClass","ui-align-right").appendChild(i.create("form").addField(i.create("textfield").attr("label","URL").value(p))).appendChild(i.create("button").attr("title","Add").on("dom:"+s.Touch.touchEndEventName,function(){var e=p();e.length>0&&(f.fire("feeds:add",e),p(""))})).appendChild(u));return d.pages([m,f]),this.ui=d,this.feeds=r,this.tempFeeds=a,this}var i=e.UI,n=e.Utils,s=e.Events,o=e.Observable;return t}),s("view/news",["meems"],function(e){function t(e){var t='<div class="news"><div class="title">{{title}}</div><div class="date">{{formattedDate}}</div><div class="author">{{author}}</div><div class="summary">{{&summary}}</div><div class="clear"></div></div>',o=s.observableArray([]),r=s.observable("News"),a=i.create("page",e).attr("enableScroll",!0).facet("header",i.create("header").attr("title",r).facet("buttonsleft",i.create("buttongroup").addButton(i.create("button").attr("title","Feeds").attr("icon","explore").on("dom:"+n.Touch.touchEndEventName,function(){a.fire("aside:toggle")})))).facet("content",i.create("list").items(o).template(t).attr("style","normal").attr("empty","<b>No news.</b><br><br>Please select a feed from the menu.").attr("sortable",!1).on("item:clicked",function(e,t){return a.fire("news:clicked",t),!0}));return this.ui=a,this.title=r,this.news=o,this}var i=e.UI,n=(e.Utils,e.Events),s=e.Observable;return t}),s("view/newsdetail",["meems"],function(e){function t(e){var t='<iframe class="news-details" src="{{link}}"></iframe>',s=n.observable(),o=n.observable("Feed title"),r=i.create("page",e).attr("enableScroll",!1).facet("header",i.create("header").attr("title",o).facet("buttonsleft",i.create("buttongroup").addButton(i.create("button").attr("title","News").attr("icon","explore").attr("action","news")).on("button:pressed",function(t,i){switch(i.attr("action")){case"news":s({link:"about:blank"}),e.fire("goto:news")}}))).facet("content",i.create("html").attr("customClass","ui-fill").attr("html",t).attr("data",s));return this.ui=r,this.title=o,this.news=s,this}var i=e.UI,n=(e.Events,e.Observable);return t}),s("view/phone",["meems","view/login","view/feeds","view/news","view/newsdetail"],function(e,t,i,n,s){function o(){var e=l.observable("RSS Reader"),o=r.create("pageholder"),u=r.create("aside"),h=r.create("pageholder"),c=new i(u);c.ui.on("feeds:clicked",function(e,t){return u.fire("aside:clicked",t),u.expanded(!1),a.Dom.applyChanges(),!0});var d=new n(h),m=new s(h),p=new t;return h.pages([d.ui,m.ui]),u.facet("content",h).facet("menu",c.ui),h.on("aside:toggle",function(){u.expanded(!u.expanded()),a.Dom.applyChanges()}),o.pages([p.ui,u]),this.ui=o,this.title=e,this.phoneUi=u,this.pageFeeds=c,this.pageNews=d,this.masterPageHolder=o,this.pageHolder=h,this.pageDetails=m,this.pageLogin=p,this}var r=e.UI,a=e.Utils,l=e.Observable;return o.prototype={refresh:function(){this.ui.update(),a.Dom.applyChanges()}},o}),s("server_conf",{url:"http://rssreaderserver.eu01.aws.af.cm/"}),s("viewmodel/login",["meems","server_conf"],function(e,t){var i=e.Utils,n=function(e,n,s){i.Ajax.request({url:t.url+"user/login",format:"json",method:"POST",params:{email:e,password:n},done:i.Fn.bind(function(e){200===e.statusCode?s():403===e.statusCode?(this.view.password(""),alert("Invalid credentials, please try again.")):alert("An error occurred, please try again later.")},this)})},s={view:null,init:function(e,t){this.parentController=e,this.view=t||this.view,"localStorage"in window&&window.localStorage.email&&window.localStorage.password&&(this.view.username(window.localStorage.email),this.view.password(window.localStorage.password),n(window.localStorage.email,window.localStorage.password,i.Fn.bind(function(){this.parentController.navigateTo("main")},this))),this.view.ui.on("login",i.Fn.bind(function(){var e=this.view.username(),t=this.view.password();n.call(this,e,t,i.Fn.bind(function(){this.parentController.navigateTo("main"),"localStorage"in window&&(window.localStorage.email=e,window.localStorage.password=t)},this))},this))}};return s}),s("viewmodel/newsdetail",[],function(){return{news:{id:null,title:null,author:null,date:null,email:null,icon:null,body:null},showNewsDetails:function(e){this.news=e,this.view.title(this.news.title),this.view.news(this.news)},view:null,parentController:null,init:function(e,t){this.parentController=e,this.view=t||this.view,this.view.news(this.news)}}}),s("viewmodel/news",["viewmodel/newsdetail"],function(e){return{news:[],showNews:function(e,t){this.news=t,this.view.title(e.name),this.view.news(this.news)},parentController:null,view:null,init:function(t,i){this.parentController=t,this.view=i||this.view;var n=this;this.view.ui.on("news:clicked",function(t,i){e.showNewsDetails(i),n.parentController.navigateTo("details")}),this.view.news(this.news)}}}),s("viewmodel/feeds",["meems","viewmodel/news","server_conf"],function(e,t,i){var n=e.Utils,s="dd/MM/yyyy hh:mm:ss",o=function(e){var t=e.getDate(),i=e.getMonth()+1,n=e.getFullYear(),o=e.getHours(),r=e.getMinutes(),a=e.getSeconds();return s.replace("dd",10>t?"0"+(""+t):""+t).replace("MM",10>i?"0"+(""+i):""+i).replace("yyyy",""+n).replace("hh",10>o?"0"+(""+o):""+o).replace("mm",10>r?"0"+(""+r):""+r).replace("ss",10>a?"0"+(""+a):""+a).replace("d",""+t).replace("M",""+i).replace("yy",(""+n).substr(2)).replace("h",""+o).replace("m",""+r).replace("s",""+a)},r=function(e){var t=e.replace("T"," ").replace(/\.\d\d\dZ/,"").replace(/\-/g,"/");return new Date(t)},a=function(e){return e.replace(/<[^>]+>/g,"")};return{feeds:null,tempFeeds:null,newsCache:{},loadFeeds:function(e){n.Ajax.request({url:i.url+"feeds",decoding:"json",method:"GET",done:n.Fn.bind(function(t){200===t.statusCode?(this.feeds(t.response),e&&e()):403===t.statusCode?this.parentController.navigateTo("login"):alert("An error occurred, please try again later.")},this)})},saveFeeds:function(e){var t,s,o,r,a=this.feeds(),l=this.tempFeeds(),u=[],h=[],c=[];for(o=0,r=a.length;r>o;++o)t=a[o],s=l.indexOf(t),-1===s&&h.push(t);for(o=0,r=l.length;r>o;++o)t=l[o],s=a.indexOf(t),-1===s?(t.order=o,u.push(t)):s!==o&&(t.order=o,c.push(t));var d=function(e){return 0==h.length?(e(),void 0):(n.Ajax.request({url:i.url+"feeds",method:"DELETE",format:"json",params:h,done:function(t){200===t.statusCode&&(h=null,e())}}),void 0)},m=function(e){return 0==c.length?(e(),void 0):(n.Ajax.request({url:i.url+"feeds",method:"PUT",format:"json",params:c,done:function(t){200===t.statusCode&&(c=null,e())}}),void 0)},p=function(e){return 0==u.length?(e(),void 0):(n.Ajax.request({url:i.url+"feeds",method:"POST",format:"json",params:u,done:function(t){200===t.statusCode&&(u=null,e())}}),void 0)},f=this;d(function(){m(function(){p(function(){f.loadFeeds(e)})})}),this.tempFeeds([])},processSingleNewsItem:function(e){return{formattedDate:o(r(e.date)),summary:a(e.summary),author:e.author,title:e.title,link:e.link}},getNewsFromFeed:function(e,t){var s=window.localStorage["lastUpdate_"+e._id]||"";window.localStorage["lastUpdate_"+e._id]=(new Date).getTime(),n.Ajax.request({url:i.url+"feeds/"+e._id,decoding:"json",method:"GET",params:{lastUpdate:s},done:n.Fn.bind(function(e){if(200===e.statusCode){for(var i=e.response.news,n=0,s=i.length;s>n;++n)i[n]=this.processSingleNewsItem(i[n]);t(e.response)}else 403===e.statusCode?this.parentController.navigateTo("login"):alert("An error occurred, please try again later.")},this)})},refreshFeeds:function(e){var t=this,i=this.feeds(),s=function(o,r){console.log("Synching "+o.url),t.getNewsFromFeed(o,function(o){var a=t.newsCache[o.feed.url];a?a.news.unshift.apply(a.news,o.news):t.newsCache[o.feed.url]={title:o.feed.name,news:o.news,lastUpdateDate:(new Date).getTime()},window.localStorage.setItem("newsCache",JSON.stringify(t.newsCache)),i.length>r+1?n.Fn.postPone(function(){s(i[r+1],r+1)}):e()})};i.length>0&&s(i[0],0)},parentController:null,view:null,init:function(e,i){this.parentController=e,this.view=i||this.view,this.feeds=this.view.feeds,this.tempFeeds=this.view.tempFeeds;var n=this,s=window.localStorage.newsCache;this.newsCache=s?JSON.parse(s):{},this.view.ui.on("feeds:clicked",function(e,i){var s=n.newsCache[i.url];s&&s.news&&s.news.length>0&&s.lastUpdateDate&&3e5>s.lastUpdateDate-(new Date).getTime()&&(t.showNews(i,s.news),n.parentController.updateUi()),n.parentController.navigateTo("news")}).on("feeds:add",function(e,t){n.tempFeeds.push({name:t,url:t}),n.parentController.updateUi()}).on("feeds:manage",function(e,t){n.tempFeeds([]),n.tempFeeds.push.apply(n.tempFeeds,n.feeds()),t&&t(!0)}).on("feeds:save",function(e,t){n.saveFeeds(function(){t&&t(!0)})}).on("feeds:cancel",function(e,t){n.tempFeeds([]),t&&t(!0)}).on("feeds:refresh",function(e,t){n.refreshFeeds(function(){t&&t()})})}}}),s("viewmodel/phone",["meems","viewmodel/login","viewmodel/feeds","viewmodel/news","viewmodel/newsdetail"],function(e,t,i,n,s){var o=e.Utils,r={navigateTo:function(e){"details"===e?this.view.pageHolder.currentPage(this.view.pageDetails.ui):"news"===e?this.view.pageHolder.currentPage(this.view.pageNews.ui):"login"===e?this.view.masterPageHolder.currentPage(this.view.pageLogin.ui):"main"===e&&i.loadFeeds(o.Fn.bind(function(){this.view.masterPageHolder.currentPage(this.view.phoneUi),o.Dom.applyChanges()},this)),o.Dom.applyChanges()},updateUi:function(){o.Dom.applyChanges()},view:null,init:function(e){this.view=e||this.view,t.init(this,this.view.pageLogin),i.init(this,this.view.pageFeeds),n.init(this,this.view.pageNews),s.init(this,this.view.pageDetails);var o=this,r=this.view.pageHolder;r.on("goto:news",function(){o.navigateTo("news")}),r.on("goto:details",function(){o.navigateTo("details")})}};return r}),n.config({paths:{meems:"./lib/meems.min",view:"./view",viewmodel:"./viewmodel",server_conf:"./server_conf"}}),window.hasPhoneGap=-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://"),hasPhoneGap?document.addEventListener("deviceready",t,!1):t(),s("js/index",function(){}),n("js/index")});